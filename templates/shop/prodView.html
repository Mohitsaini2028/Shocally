{% extends 'base.html' %}

{% block title %} ShocallyHomePage {% endblock title %}

{% load static %}

{% block link %}
<link rel="stylesheet" href="{% static 'css/shop/ratingStyle.css' %}">
<link rel="stylesheet" href="{% static 'css/shop/slider.css' %}">

{% endblock %}

{% block body %}
<div class="container my-4">
    <div class="row">
    <div class="col-md-4">
    <div class="row">
        <img src="/media/{{product.image}}"  width="233px" height="385px">
    </div>
        <div class="row">
            <button type="button" class="btn btn-primary mr-2" id="buy{{product.id}}"  data-toggle="modal" data-target="#buyModal">
            Buy Now
            </button>
            <span id="divpr{{product.id}}" class="divpr" >
                <button id="pr{{product.id}}" class="btn btn-primary cart">Add To Cart</button>
            </span>
        </div>

    </div>

    <div class="col-md-8">
        <h5 class="text-success my-4" id="namepr{{product.id}}">{{product.product_name|title}}</h5>
        <p>{{product.desc}}</p>
        {% if product.Save is not 0 %}
          <p><b>Price : </b> <del class="text-danger">Rs. {{product.originalPrice}} </del></p>
          <p><b>Deal of the Day  : </b> Rs.<span class="text-info" id="pricepr{{product.id}}">{{product.price}}</span></p>
          <!-- <p><b>Deal of the Day : </b> Rs.{{product.price|add:"-5"}} </p> -->
          <p><b>Discount : </b> {{product.Discount}} %</p>
          <p><b>You Save : </b> Rs. {{ product.Save}} </p>
        {% else %}
        <p><b>Deal of the Day  : </b>Rs. {{product.originalPrice}}</p>
        {% endif %}
        <div class="rate m-0 p-0" id="rating" data-toggle="modal" data-target="#RatingModal">
          <input type="radio" id="star5" name="rate" value="5" />
          <label for="star5" title="text">5 stars</label>
          <input type="radio" id="star4" name="rate" value="4" />
          <label for="star4" title="text">4 stars</label>
          <input type="radio" id="star3" name="rate" value="3" />
          <label for="star3" title="text">3 stars</label>
          <input type="radio" id="star2" name="rate"  value="2" />
          <label for="star2" title="text">2 stars</label>
          <input type="radio" id="star1" name="rate" value="1" />
          <label for="star1" title="text">1 star</label>
      </div>
      <p>{{product.rating}}<p>
    </div>
    </div>


</div>



<div class="modal fade" id="RatingModal" tabindex="-1" aria-labelledby="RatingModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="RatingModalTitle">Give Your Rating Here</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="shop/prodRatingUpdate/" method="post">
        {% csrf_token %}
  <div class="form-group">

    <input type="hidden" class="form-control" id="productId" name="productId" value="{{ product.id }}">
    <input type="hidden" class="form-control" id="RatingGiven" name="RatingGiven" value="" >
  </div>


  <h4>How much you rate this product </h4>
  <div class="form-group">

    <div class="rate m-0 p-0" id="ratingNo">
    <input type="radio" id="star-5" name="rate" value="5" />
    <label for="star5" title="text">5 stars</label>
    <input type="radio" id="star-4" name="rate" value="4" />
    <label for="star4" title="text">4 stars</label>
    <input type="radio" id="star-3" name="rate" value="3" />
    <label for="star3" title="text">3 stars</label>
    <input type="radio" id="star-2" name="rate" value="2" />
    <label for="star2" title="text">2 stars</label>
    <input type="radio" id="star-1" name="rate" value="1" />
    <label for="star1" title="text">1 star</label>
    </div>

    <!-- <input type="number" class="form-control" max="5" min="0" id="ratingNo" name="ratingNo" placeholder=" "> -->
  </div>

        <!-- <button type="submit" class="btn btn-primary">Submit</button> -->
</form>
      </div>
       <div class="modal-footer">
      </div>
</div>
</div>
</div>

<form  id="cartForm" method="post">
  {% csrf_token %}
  <input type="hidden" name="cartData" id="cartData" value="">
  <input type="hidden" name="user" id="user" value="{{user}}">
  </form>



<!-- Buy Now  -->
  <div class="modal fade" id="buyModal" tabindex="-1" aria-labelledby="buyModal" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalTitle">Buy Now</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form action="/shop/buyNow/" method="post">
          {% csrf_token %}
    <div class="form-group">
      <label for="quantity">Enter the Quantity</label>
      <input type="number" class="form-control" id="quantity" name="quantity" placeholder="Enter the Number ">
    </div>

      <input type="hidden" id="price" name="price" value="{{product.price}}">

    <input type="hidden"  id="prodName" name="prodName" value="{{product.product_name}}">
    <input type="hidden"  id="prodId" name="prodId" value="{{product.id}}">
    <input type="hidden"  id="orgPrice" name="orgPrice" value="{{product.originalPrice}}">

          <button type="submit" class="btn btn-primary">Confirm Buy</button>
  </form>
        </div>
         <div class="modal-footer">
        </div>
  </div>
  </div>
  </div>


  {% for i in recommendations %}
    <p>{{i}}<p>
  {% endfor %}


{% endblock %}





{% block js %}



<script src="{% static 'js/shop/cartManage.js' %}"></script>

<script>
  console.log(2*parseInt({{product.rating}}))
  s=document.getElementById('rating');
  y=s.children

  if ( {{product.rating}} != 0.0){
    y[10-2*parseInt({{product.rating}})].checked=true;
  }

</script>


<!-- <script>
console.log('working');

if(localStorage.getItem('cart') == null){
var cart = {};
}

else
{
cart = JSON.parse(localStorage.getItem('cart'));
document.getElementById('cart').innerHTML = Object.keys(cart).length;
}

$('.cart').click(function(){

console.log('clicked');
var idstr = this.id.toString();
console.log(idstr);
if (cart[idstr] !=undefined){
cart[idstr] = cart[idstr] + 1;
}
else
{
cart[idstr] = 1;
}
console.log(cart);
localStorage.setItem('cart', JSON.stringify(cart));
document.getElementById('cart').innerHTML = Object.keys(cart).length;
});
$('#popcart').popover();

document.getElementById("popcart").setAttribute('data-content', '<h5>Cart for your items in my shopping cart</h5>');

<!-- </script> -->

{% endblock js %}
